#!/bin/bash

# ?????? ??? ??????? ??????? ? ???????????? ????????? ????????????

echo "???????? ??????? ???????..."

# 1. ??????? Docker-???????? (?????????? ???????????? ??????)
echo "????????? ??????? Docker-????????..."
./docker-cleanup.sh

# 2. ??????? ????????? ??????
echo "??????? ????????? ??????..."
sudo rm -rf /tmp/*
sudo rm -rf /var/tmp/*

# 3. ??????? ???????? ???????
echo "??????? ???????? ???????..."
sudo journalctl --vacuum-time=3d

# 4. ??????? ???? ????????? ????????? apt
echo "??????? ???? apt..."
sudo apt clean
sudo apt autoremove -y

# 5. ????? ? ?????? ??????? ??????
echo "?????? ??????? ?????? ? ???????..."
echo "???-10 ????? ??????? ?????????? ? /var:"
sudo du -h /var --max-depth=2 | sort -hr | head -10

echo "???-10 ????? ??????? ?????????? ? /:"
sudo du -h / --max-depth=2 2>/dev/null | sort -hr | head -10

# 6. ???????? ? ??????? ?????
echo "??????? ?????? ?????..."
sudo find /var/log -type f -name "*.gz" -delete
sudo find /var/log -type f -name "*.old" -delete
sudo find /var/log -type f -name "*.1" -delete
sudo find /var/log -type f -name "*.2" -delete
sudo find /var/log -type f -name "*.3" -delete
sudo find /var/log -type f -name "*.4" -delete
sudo find /var/log -type f -name "*.5" -delete

# 7. ???????? ????????? ???????????? ????? ???????
echo "???????? ????????? ???????????? ????? ???????:"
df -h

echo "??????? ??????? ?????????."